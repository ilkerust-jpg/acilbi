<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Acilbi Sahip Giriş</title>
<style>
body{font-family:system-ui;background:#f4f4f4;padding:18px}
.card{background:#fff;padding:16px;border-radius:12px}
input,select,button{width:100%;padding:12px;margin-top:10px;border-radius:8px;border:1px solid #ccc}
button{background:#111;color:#fff;border:none;font-weight:bold}
#status{margin-top:10px;font-weight:bold}
</style>
</head>
<body>

<div class="card">
<input id="ownerPass" placeholder="Sahip Şifresi">
<input id="name" placeholder="Ad Soyad">

<select id="birthYear"></select>

<select id="blood">
<option value="">Kan Grubu</option>
<option>0 Rh+</option><option>0 Rh-</option>
<option>A Rh+</option><option>A Rh-</option>
<option>B Rh+</option><option>B Rh-</option>
<option>AB Rh+</option><option>AB Rh-</option>
</select>

<input id="illness" placeholder="Kronik Rahatsızlıklar">
<input id="meds" placeholder="Rutin İlaçlar">
<input id="allergy" placeholder="Alerjiler">
<input id="emergency" placeholder="Acil Kişi Telefon">

<button onclick="save()">Bilgileri Kaydet</button>
<div id="status"></div>
</div>

<script>
const params = new URLSearchParams(location.search)
const id = params.get("id")

const y = new Date().getFullYear();
for(let i=y;i>=1920;i--){
  birthYear.innerHTML += `<option value="${i}">${i}</option>`
}

async function save(){
  status.innerText = "Kaydediliyor..."
  status.style.color = "#555"

  const res = await fetch("https://acilbi.com/save?id="+id,{
    method:"POST",
    headers:{'Content-Type':'application/json'},
    body:JSON.stringify({
      ownerPass: ownerPass.value,
      name: name.value,
      birthYear: birthYear.value,
      blood: blood.value,
      illness: illness.value,
      meds: meds.value,
      allergy: allergy.value,
      emergency: emergency.value
    })
  })

  const t = await res.text()
  status.innerText = t
  status.style.color = res.ok ? "green" : "red"
}
</script>

</body>
</html>
