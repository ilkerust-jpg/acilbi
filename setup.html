<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>acilbi – Sahip Girişi</title>
<style>
body{font-family:system-ui;background:#f4f4f4;margin:0;padding:20px}
input,select,textarea,button{width:100%;padding:12px;margin-top:10px;font-size:16px;border-radius:8px;border:1px solid #ccc}
button{background:#111;color:white;border:none}
.panel{background:white;padding:15px;border-radius:10px;margin-top:15px}
h2{text-align:center}
</style>
</head>
<body>

<h2>Bileklik Sahibi Bilgi Girişi</h2>

<div class="panel">
<label>Bileklik Kodu</label>
<input id="idInput" placeholder="Örn: YHOO7R">

<label>Sahip Şifresi</label>
<input id="passInput" placeholder="Kutudan çıkan şifre">

<button onclick="loadData()">Bilgileri Yükle</button>
</div>

<div id="formPanel" class="panel" style="display:none">
<label>Ad Soyad</label>
<input id="name">

<label>Doğum Yılı</label>
<select id="birthYear"></select>

<label>Kan Grubu</label>
<select id="blood">
<option value="">Seçiniz</option>
<option>A+</option><option>A-</option>
<option>B+</option><option>B-</option>
<option>AB+</option><option>AB-</option>
<option>0+</option><option>0-</option>
</select>

<label>Kronik Rahatsızlıklar</label>
<textarea id="illness"></textarea>

<label>Rutin İlaçlar</label>
<textarea id="meds"></textarea>

<label>Alerjiler</label>
<textarea id="allergy"></textarea>

<label>Acil Kişi Telefon</label>
<input id="emergency">

<button onclick="saveData()">Bilgileri Kaydet</button>
</div>

<script>
const api = "https://acilbi.com/api";

for(let y=new Date().getFullYear(); y>=1930; y--){
  let o=document.createElement("option");
  o.value=y; o.text=y;
  birthYear.appendChild(o);
}

async function loadData(){
  const id=idInput.value.trim().toUpperCase();
  const pass=passInput.value.trim();

  const r = await fetch(api+"?id="+id+"&pass="+pass);
  const d = await r.json();

  if(!d.success){ alert("Kod veya şifre yanlış"); return; }

  formPanel.style.display="block";
  name.value=d.name||"";
  birthYear.value=d.birthYear||"";
  blood.value=d.blood||"";
  illness.value=d.illness||"";
  meds.value=d.meds||"";
  allergy.value=d.allergy||"";
  emergency.value=d.emergency||"";
}

async function saveData(){
  const id=idInput.value.trim().toUpperCase();
  const pass=passInput.value.trim();

  const body={
    id, pass,
    name:name.value,
    birthYear:birthYear.value,
    blood:blood.value,
    illness:illness.value,
    meds:meds.value,
    allergy:allergy.value,
    emergency:emergency.value
  };

  const r=await fetch(api,{method:"POST",body:JSON.stringify(body)});
  const d=await r.json();

  if(d.success) alert("Bilgiler kaydedildi");
  else alert("Hata oluştu");
}
</script>

</body>
</html>
