<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Acilbi Sahip Giriş</title>
<style>
body{font-family:system-ui;background:#f3f3f3;padding:16px}
.card{max-width:480px;margin:auto;background:#fff;padding:20px;border-radius:12px}
input,select,button{width:100%;padding:12px;margin-top:10px;border-radius:8px;border:1px solid #ccc;font-size:16px}
button{background:#000;color:#fff;font-weight:bold}
#msg{margin-top:10px;text-align:center;font-weight:bold}
</style>
</head>
<body>
<div class="card">
<h2>Bileklik Sahibi Bilgi Girişi</h2>

<input id="pass" placeholder="Kutu içindeki şifre">
<input id="name" placeholder="Ad Soyad">

<label>Doğum Yılı</label>
<select id="birthYear"></select>

<label>Kan Grubu</label>
<select id="blood">
<option value="">Seçiniz</option>
<option>A Rh+</option><option>A Rh-</option>
<option>B Rh+</option><option>B Rh-</option>
<option>AB Rh+</option><option>AB Rh-</option>
<option>0 Rh+</option><option>0 Rh-</option>
</select>

<input id="illness" placeholder="Kronik Rahatsızlıklar">
<input id="meds" placeholder="Rutin İlaçlar">
<input id="allergy" placeholder="Alerjiler">
<input id="emergency" placeholder="Acil Kişi Telefon">

<button onclick="save()">Bilgileri Kaydet</button>
<div id="msg"></div>
</div>

<script>
const yearSelect = document.getElementById("birthYear")
for(let y=new Date().getFullYear();y>=1920;y--){
  const o=document.createElement("option")
  o.value=y;o.text=y
  yearSelect.add(o)
}

async function save(){
  const id = new URLSearchParams(location.search).get("id")
  if(!id){ alert("ID bulunamadı"); return }

  const data = {
    id,
    ownerPass: pass.value,
    name: name.value,
    birthYear: birthYear.value,
    blood: blood.value,
    illness: illness.value,
    meds: meds.value,
    allergy: allergy.value,
    emergency: emergency.value
  }

  const r = await fetch("https://acilbi.com/save",{
    method:"POST",
    headers:{"Content-Type":"application/json"},
    body:JSON.stringify(data)
  })

  if(r.ok){
    msg.innerText="✔ Bilgiler kaydedildi"
    msg.style.color="green"
  }else{
    msg.innerText="❌ Şifre yanlış veya hata var"
    msg.style.color="red"
  }
}
</script>
</body>
</html>
