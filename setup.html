<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Acilbi ‚Äì Sahip Bilgi Giri≈üi</title>
<style>
body{font-family:system-ui;background:#f4f4f4;margin:0;padding:18px}
.card{background:#fff;padding:16px;border-radius:12px;box-shadow:0 2px 6px rgba(0,0,0,0.08)}
input,select,button{width:100%;padding:12px;margin-top:10px;font-size:16px;border-radius:8px;border:1px solid #ccc}
button{background:#111;color:#fff;border:none;font-weight:600}
h2{margin-top:0}
.small{font-size:14px;color:#666}
#status{margin-top:12px;font-size:15px;font-weight:600}
</style>
</head>
<body>

<div class="card">
<h2>üìù Sahip Bilgi Giri≈üi</h2>
<div class="small">Bileklik bilgilerini doldurun</div>

<input id="ownerPass" placeholder="Kutudan √ßƒ±kan sahip ≈üifresi">
<input id="name" placeholder="Ad Soyad">

<select id="birthYear"></select>

<select id="blood">
<option value="">Kan Grubu Se√ßin</option>
<option>0 Rh+</option>
<option>0 Rh-</option>
<option>A Rh+</option>
<option>A Rh-</option>
<option>B Rh+</option>
<option>B Rh-</option>
<option>AB Rh+</option>
<option>AB Rh-</option>
</select>

<input id="illness" placeholder="Kronik Rahatsƒ±zlƒ±klar">
<input id="meds" placeholder="Rutin ƒ∞la√ßlar">
<input id="allergy" placeholder="Alerjiler">
<input id="emergency" placeholder="Acil Ki≈üi Telefon">

<button onclick="save()">Bilgileri Kaydet</button>
<div id="status"></div>
</div>

<script>
// Doƒüum yƒ±lƒ± dropdown
const y = new Date().getFullYear();
for(let i=y;i>=1920;i--){
  birthYear.innerHTML += `<option value="${i}">${i}</option>`
}

// URL'den ID al
const params = new URLSearchParams(location.search)
const id = params.get("id")

async function save(){
  status.innerText = "Kaydediliyor..."
  status.style.color = "#555"

  const res = await fetch("https://acilbi.com/save?id="+id,{
    method:"POST",
    headers:{'Content-Type':'application/json'},
    body: JSON.stringify({
      ownerPass: ownerPass.value,
      name: name.value,
      birthYear: birthYear.value,
      blood: blood.value,
      illness: illness.value,
      meds: meds.value,
      allergy: allergy.value,
      emergency: emergency.value
    })
  })

  const t = await res.text()

  if(res.ok){
    status.innerText = t
    status.style.color = "green"
  } else {
    status.innerText = t
    status.style.color = "red"
  }
}
</script>

</body>
</html>
