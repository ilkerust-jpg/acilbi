<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>acilbi</title>
<style>
body{margin:0;font-family:system-ui;background:#111;color:#fff;text-align:center}
.card{background:#fff;color:#111;margin:20px;border-radius:16px;padding:20px}
h1{margin-top:20px}
.badge{background:#d32f2f;color:#fff;padding:10px;border-radius:8px;font-weight:700;margin:10px 0}
.info{margin:8px 0;font-size:18px}
.btn{display:block;width:90%;margin:12px auto;padding:14px;font-size:18px;border-radius:12px;border:none}
.call{background:#111;color:#fff}
.emergency{background:#c62828;color:#fff;font-weight:700}
.footer{font-size:14px;color:#bbb;margin-top:15px}
</style>
</head>
<body>

<h1>acilbi</h1>
<div class="badge">Bu kişi yardımınıza ihtiyaç duyabilir</div>

<div class="card" id="infoBox">Yükleniyor...</div>

<button class="btn call" id="callBtn" style="display:none">Acil Kişiyi Ara</button>
<button class="btn emergency" onclick="window.location.href='tel:112'">112'yi Ara</button>

<div class="footer">Bu bileklik Acilbi Acil Durum Sistemi'ne bağlıdır</div>

<script>
const params = new URLSearchParams(window.location.search)
const id = params.get("id")

if(!id){
  document.getElementById("infoBox").innerHTML = "Geçersiz bileklik"
} else {
  fetch("https://acilbi.com/get?id=" + id)
  .then(res => res.json())
  .then(data => {
    if(data.error){
      document.getElementById("infoBox").innerHTML = "Kayıt bulunamadı"
      return
    }

    let html = "<h2>" + (data.name || "İsim girilmemiş") + "</h2>"

    if(data.birthYear){
      const age = new Date().getFullYear() - data.birthYear
      html += `<div class="info"><b>Doğum Yılı:</b> ${data.birthYear} (Yaş: ${age})</div>`
    }

    if(data.blood) html += `<div class="info"><b>Kan Grubu:</b> ${data.blood}</div>`
    if(data.illness) html += `<div class="info"><b>Kronik Rahatsızlıklar:</b> ${data.illness}</div>`
    if(data.meds) html += `<div class="info"><b>Rutin İlaçlar:</b> ${data.meds}</div>`
    if(data.allergy) html += `<div class="info"><b>Alerjiler:</b> ${data.allergy}</div>`

    if(data.emergency){
      document.getElementById("callBtn").style.display = "block"
      document.getElementById("callBtn").innerText = "Acil Kişiyi Ara"
      document.getElementById("callBtn").onclick = () => {
        window.location.href = "tel:" + data.emergency
      }
    }

    document.getElementById("infoBox").innerHTML = html
  })
}
</script>

</body>
</html>
